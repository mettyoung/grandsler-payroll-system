<link rel="stylesheet" href="./components/production_order/production_order.template.css">
<!-- Load error message; hides the content and saveSelectedMasterItem button if loading error occurs. -->
<div id="load-error-message" class="alert alert-danger" ng-hide="!$ctrl.load_error">
    <strong>{{$ctrl.load_error.name}}:</strong> {{$ctrl.load_error.message}}
</div>

<!-- Row: Master list and detail content. -->
<div id="main-content" layout="row" flex ng-hide="$ctrl.load_error">
    <!-- Master List -->
    <div id="master-container" layout="column" flex="40" md-whiteframe="4">
        <!-- Query Parameters -->
        <md-toolbar class="md-table-toolbar md-default">
            <div class="md-toolbar-tools" flex>
                <form layout="row" flex>
                    <input flex type="text" ng-model="$ctrl.query.name" md-auto-focus="true"
                           placeholder="Search Employee Name">
                    <md-button class="md-icon-button" ng-click="$ctrl.showFilter = !$ctrl.showFilter">
                        <md-icon md-svg-icon="content:ic_filter_list_24px"></md-icon>
                    </md-button>
                    <md-button class="md-icon-button" type="submit" ng-click="$ctrl.commands.load()">
                        <md-icon md-svg-icon="action:ic_search_24px"></md-icon>
                    </md-button>
                    <md-button class="md-icon-button" ng-click="$ctrl.commands.createMasterItem()">
                        <md-icon md-svg-icon="content:ic_add_24px"></md-icon>
                    </md-button>
                </form>
            </div>
            <div class="query-parameters" layout="column" ng-show="$ctrl.showFilter">
                <md-input-container>
                    <label>Employee Type</label>
                    <md-select ng-model="$ctrl.query.employee_type">
                        <md-option ng-value="0" selected>All</md-option>
                        <md-option ng-value="'Time-based'">Time-based</md-option>
                        <md-option ng-value="'Output-based'">Output-based</md-option>
                    </md-select>
                </md-input-container>
                <md-input-container>
                    <label>Status</label>
                    <md-select ng-model="$ctrl.query.is_active">
                        <md-option ng-value="0" selected>All</md-option>
                        <md-option ng-value="true">Active</md-option>
                        <md-option ng-value="false">Inactive</md-option>
                    </md-select>
                </md-input-container>
                <md-input-container>
                    <label>Position</label>
                    <md-select ng-model="$ctrl.query.position_id">
                        <md-option ng-value="0" selected>All</md-option>
                        <md-option ng-value="position.id" ng-repeat="position in $ctrl.data.positions">{{position.name}}
                        </md-option>
                    </md-select>
                </md-input-container>
                <md-input-container ng-show="$ctrl.auth.user.hasPermission('User Management')">
                    <label>Has User Access</label>
                    <md-select ng-model="$ctrl.query.has_user_access">
                        <md-option ng-value="0" selected>All</md-option>
                        <md-option ng-value="true">Yes</md-option>
                        <md-option ng-value="false">No</md-option>
                        </md-option>
                    </md-select>
                </md-input-container>
            </div>
            <md-table-pagination md-limit="$ctrl.query.limit" md-limit-options="$ctrl.preset.limitOptions"
                                 md-page="$ctrl.query.page" md-total="{{$ctrl.data.total_count}}"
                                 md-on-paginate="$ctrl.commands.load" md-page-select>
            </md-table-pagination>
        </md-toolbar>
        <md-content flex>
            <md-list flex>
                <md-list-item ng-repeat="productionOrder in $ctrl.data.selected"
                              ng-click="$ctrl.commands.selectMasterItem(productionOrder)">
                    <div layout="row" flex>
                        <div layout="column" flex="50" layout-align="center start">
                            <div layout="row" flex><strong>Batch:&nbsp;</strong>12</div>
                            <div layout="row" flex><strong>Stock Code:&nbsp;</strong>SKU 123</div>
                            <div layout="row" flex><strong>Color:&nbsp;</strong>Orange</div>
                            <div layout="row" flex><strong>Size:&nbsp;</strong>Small</div>
                        </div>
                        <div layout="column" flex="50" layout-align="center end">
                            <div layout="row" flex></div>
                            <div layout="row" flex><strong>Employee:&nbsp;</strong>101</div>
                            <div layout="row" flex><strong>Quantity In:&nbsp;</strong>10x12,2</div>
                            <div layout="row" flex><strong>Quantity Out:&nbsp;</strong>5x12,2</div>
                        </div>
                    </div>
                    <md-divider ng-if="!$last"></md-divider>
                </md-list-item>
            </md-list>
        </md-content>
    </div>

    <!-- Column: Detail load error, write error and content.. -->
    <div id="detail-container" flex layout="column">
        <!-- This error occurs on selecting an item. -->
        <div id="detail-load-error-message" class="alert alert-danger" ng-hide="!$ctrl.detail_load_error">
            <strong>{{$ctrl.detail_load_error.name}}:</strong> {{$ctrl.detail_load_error.message}}
        </div>
        <!-- This error occurs on saving -->
        <div id="save-error-message" class="alert alert-danger" ng-hide="!$ctrl.write_error">
            <strong>{{$ctrl.write_error.name}}:</strong> {{$ctrl.write_error.message}}
        </div>
        <!-- Hides this if detail_load_error occurred. -->
        <md-content ng-hide="$ctrl.detail_load_error" layout="column" flex>
            <md-input-container flex>
                <label>Color Name</label>
                <input required name="name" ng-model="$ctrl.selected_item.name" md-auto-focus="true">
                <div ng-messages="$ctrl.Form.name.$error" ng-show="$ctrl.Form.name.$touched">
                    <div ng-message="required">This is required.</div>
                </div>
            </md-input-container>
        </md-content>
    </div>
</div>